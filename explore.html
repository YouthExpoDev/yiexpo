<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Explore Projects â€” Y-I-Expo</title>

<link href="https://fonts.googleapis.com/css2?family=Hanken+Grotesk:wght@400;700;900&display=swap" rel="stylesheet">

<style>
  body {
    margin:0;
    background:#f7f8fb;
    font-family:"Hanken Grotesk",sans-serif;
    color:#0f172a;
  }
  .container { max-width:1100px; margin:30px auto; padding:24px; }

  /* Top bar */
  .topbar { display:flex; justify-content:space-between; align-items:center; }
  .brand { font-weight:900; letter-spacing:6px; font-size:20px; }
  .top-controls { display:flex; gap:14px; }
  .toggle-btn,.dev-btn {
    padding:8px 12px; border-radius:8px; cursor:pointer;
    border:1px solid transparent; font-weight:600;
  }
  .toggle-btn { background:rgba(255,255,255,0.5); }
  .dev-btn { background:transparent; color:#777; }

  /* Project cards */
  .project-card {
    background:white;
    padding:18px;
    border-radius:12px;
    box-shadow:0 6px 18px rgba(0,0,0,0.07);
    margin-bottom:20px;
    position:relative;
  }

  .topic { font-size:22px; font-weight:900; text-align:right; }
  .theme { font-size:14px; color:#666; text-align:right; margin-top:4px; }

  .subject { font-size:14px; font-weight:600; margin-top:12px; text-align:left; }

  .leader-block { text-align:right; margin-top:12px; }
  .leader-block div { margin-bottom:4px; }

  .class-sec {
    margin-top:12px;
    font-size:13px;
    font-weight:600;
    color:#444;
  }
</style>

<!-- SheetJS for reading Excel -->
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

</head>
<body>

<div class="container">

  <!-- Top Navigation -->
  <header class="topbar">
    <div class="brand">Y-I-Expo</div>
    <div class="top-controls">
      <button class="toggle-btn" id="themeToggle">Dark/Light</button>
      <button class="dev-btn" onclick="location.href='dev.html'">Developer</button>
    </div>
  </header>

  <h1 style="text-align:center;margin-top:30px;">Explore Projects</h1>

  <div id="projectList" style="margin-top:30px;"></div>

</div>



<script>
/* ============================
   DARK-LIGHT MODE
============================ */
document.getElementById("themeToggle").onclick = () => {
  const d = document.documentElement.getAttribute("data-theme")==="dark";
  document.documentElement.setAttribute("data-theme", d?"":"dark");
};



/* ============================
   LOAD & PARSE EXCEL
============================ */
fetch("projects.xlsx")
  .then(res => res.arrayBuffer())
  .then(buffer => {
    const wb = XLSX.read(buffer, { type:"array" });
    const sheet = wb.SheetNames[0];
    const data = XLSX.utils.sheet_to_json(wb.Sheets[sheet]);
    renderProjects(data);
  });

/* ============================
   RENDER PROJECT CARDS
============================ */
function renderProjects(rows){
  const box = document.getElementById("projectList");
  box.innerHTML="";

  rows.forEach(row=>{
    let participantsList = "";

    if(row.Participants){
      participantsList = row.Participants
        .split(",")
        .map(p => `<div>${p.trim()}</div>`)
        .join("");
    }

    const div = document.createElement("div");
    div.className = "project-card";

    div.innerHTML = `
      <div class="topic">${row.Topic || ""}</div>

      <div class="theme">${row.Theme || ""}</div>

      <div class="subject">${row.Subject || ""}</div>

      <div class="leader-block">
        <div><strong>Leader:</strong> ${row.Leader || ""}</div>
        <div><strong>Participants:</strong></div>
        <div>${participantsList}</div>
      </div>

      <div class="class-sec">
        Class: ${row.Class || ""} &nbsp;&nbsp; Section: ${row.Section || ""}
      </div>
    `;

    box.appendChild(div);
  });
}



/* ============================
   DISABLE INSPECT & RIGHT-CLICK
============================ */
document.addEventListener("contextmenu", e => e.preventDefault());

document.addEventListener("keydown", function(e){
  if(
    e.key === "F12" ||
    (e.ctrlKey && e.shiftKey && ["I","J","C"].includes(e.key)) ||
    (e.ctrlKey && e.key === "U") ||
    (e.ctrlKey && e.key === "S")
  ){
    e.preventDefault();
  }
});

/* Anti-debugger loop */
setInterval(function(){
  const before = new Date();
  debugger;
  if(new Date() - before > 50){
    document.body.innerHTML = "<h1 style='text-align:center;margin-top:50px;'>Unauthorized Access Blocked</h1>";
  }
}, 2000);
</script>

</body>
</html>
